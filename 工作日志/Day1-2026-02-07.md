# Day 1 — 2026-02-07 — 基础 Agent 搭建

## 今日目标

用 LangChain + LangGraph 预构建函数，跑通一个能调用工具的基础 Agent。

## 完成内容

### 1. 项目基础设施
- [x] 创建 `.gitignore` — 保护 `.env`、`__pycache__`、`vectorstore/` 等
- [x] 创建 `.env` — 将 API key 从代码中迁移到环境变量
- [x] 创建 `requirements.txt` — 记录所有依赖及版本
- [x] 安装依赖 — langchain-community, langchain-core, langgraph, dashscope 等

### 2. agent 包
- [x] `agent/__init__.py` — 包标记
- [x] `agent/config.py` — 用 python-dotenv 加载 `.env`，导出 `DASHSCOPE_API_KEY` 和 `MODEL_NAME`
- [x] `agent/llm.py` — 封装 `ChatTongyi` 实例化（DeepSeek V3.1 via DashScope）

### 3. 工具实现
- [x] `agent/tools.py` — 3 个工具:
  - `get_current_datetime` — 获取当前日期时间（含中文星期）
  - `calculate` — 基于 AST 的安全数学计算（非 eval，防代码注入）
  - `web_search` — DuckDuckGo HTML 搜索（httpx + 正则提取摘要）

### 4. CLI 入口
- [x] `main.py` — 使用 `langgraph.prebuilt.create_react_agent` 创建 Agent，实现交互式聊天循环
  - 支持多轮对话
  - 支持 `quit`/`exit` 退出、`clear` 清空对话

### 5. 旧代码修改
- [x] `test.py` — 移除硬编码 API key，改用 `agent.config` 模块

## 测试结果

- ✅ 配置模块加载正常
- ✅ 3 个工具注册成功: `['get_current_datetime', 'calculate', 'web_search']`
- ✅ Agent 创建成功 (`CompiledStateGraph`)
- ✅ 端到端测试通过: 输入 "What is 123 * 456?" → Agent 调用 calculate 工具 → 返回 56,088

## 最终项目结构

```
e:\MyAgent\
├── .env
├── .gitignore
├── requirements.txt
├── test.py
├── main.py
└── agent/
    ├── __init__.py
    ├── config.py
    ├── llm.py
    └── tools.py
```

## 注意事项

- Python 3.14 有 Pydantic V1 兼容警告，不影响功能
- `create_react_agent` 有 deprecation 警告（已迁移到 `langchain.agents`），当前仍可正常使用
- API key 已在 git 历史中暴露（commit 3b445fb），后续应在 DashScope 控制台轮换

## 下一步

Phase 2 — 加入 RAG，让 Agent 能基于本地文档回答问题。
